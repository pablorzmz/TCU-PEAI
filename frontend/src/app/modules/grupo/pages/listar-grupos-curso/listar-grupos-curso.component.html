<div class="p-3 w-100" *ngIf="grupos">
  <!--Navbar-->
  <div class="row mx-0 w-100 my-4">
    <div class="col-sm">
      <div class="d-flex justify-content-between flex-wrap">
        <h5>Grupos</h5>
        <app-agregar-grupos-curso class="flex-shrink-0" *ngIf="this.authService.validarTienePermisoEnAlgunPerfilDeInstitucion(constantes.AGREGAR_GRUPOS.ID, this.nombreInstitucion)" (valueChange)="actualizarGrupos($event)" [curso]="curso"></app-agregar-grupos-curso>
      </div>
      <div *ngIf="grupos.length == 0" class="alert alert-warning my-4" role="alert">
        Este curso no cuenta con grupos asociados
      </div>
    </div>
  </div>

  <div *ngIf="grupos.length > 0" class="row mx-0 w-100">
    <div class="col-md-12 mb-1" *ngFor="let grupo of grupos">
      <nav class="navbar navbar-light"  style="background-color: #DCEDF6">
        <h5 style="color: #005A70">Grupo {{grupo.id.numero}} - {{grupo.id.periodoTiempo}}</h5>
        <!-- Se agregan las subsecciones por cada grupo -->
      </nav>
      <button class="btn btn-lg btn-block text-left my-1" type="button" data-toggle="collapse" [attr.data-target]="'#collapseExample' + grupo.id.numero" aria-expanded="false" aria-controls="collapseExample" style="background-color: #FFCF01">
        Material
      </button>
      <div class="row">
        <div class="col">
          <div class="float-right">
            <!-- Componente para crear subsecciones de material que reciben el grupo-->
            <app-agregar-subseccion-material-grupo [grupo]="grupo" (sbmValueChange)="crearSubseccionMaterial($event)"></app-agregar-subseccion-material-grupo>
          </div>
        </div>
      </div>
      <div class="collapse show" [id]="'collapseExample' + grupo.id.numero">
          <div *ngFor="let sbm of listaSubseccionMateriales">
            <div class="card" *ngIf="grupo.id.numero == sbm.grupo.id.numero">
              <div class="card-header" style="font-style: oblique">
                <div class="row">
                  <div class="col-sm">
                    Subsección: {{' ' + sbm.nombre}}
                  </div>
                  <div class="mx-3" *ngIf="sbm.habilitada">
                    <button class="btn btn-sm btn-success">
                      Habilitada
                    </button>
                  </div>
                  <div class="mx-3" *ngIf="!sbm.habilitada">
                    <button class="btn btn-sm btn-danger">
                      Deshabilitada
                    </button>
                  </div>
                </div>
              </div>
              <div class="card-body">
                <div class="row my-2">
                  <div class="d-flex flex-wrap justify-content-end w-100 mx-3">
                      <app-editar-subseccion-material-grupo (sbmActualizarValueChange)="actualizarSubseccionMaterial($event)" [grupo]="grupo" [sbmAEditar]="sbm" class="mx-1"></app-editar-subseccion-material-grupo>
                      <app-eliminar-subseccion-material-grupo (sbmEliminarValueChange)="eliminarSubseccionMaterial($event)" [nombreInstitucion]="grupo.curso.areaTematica.institucion.institucionPK.nombre" [sbm]="sbm"></app-eliminar-subseccion-material-grupo>
                  </div>
                </div>
                <div class="row">
                  <div class="col">
                    <!-- Se cargan los materiales para cada subseccion -->
                    <div *ngFor="let materiales of listaMateriales">
                      <div *ngIf="materiales.sbm_id == sbm.id" >
                        <p *ngIf="materiales.sbm_material.length <= 0">
                          Sin materiales disponibles.
                        </p>
                        <div *ngFor="let m of materiales.sbm_material">
                          <div class="card">
                            <div class="card-header" style="background-color: #DCEDF6">
                              <h6 class="card-title" style="color: #005A70">
                                {{m.id.nombre}}
                              </h6>
                              <p class="card-subtitle mb-2 text-muted">
                                <mat-icon class="mr-1" style="color: red; vertical-align: middle">picture_as_pdf</mat-icon>
                                {{m.tipo}}
                              </p>
                            </div>
                            <div class="card-body">
                              <p class="card-subtitle mb-2 text-muted"> Descripción: {{' ' + m.descripcion}}</p>
                            </div>
                            <div class="card-footer bg-transparent">
                              <button [routerLink]="['material',m.id.nombre,m.id.subSeccionMaterialId]" type="button" class="btn btn-primary btn-sm">Ir al material</button>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
  </div>
</div>
